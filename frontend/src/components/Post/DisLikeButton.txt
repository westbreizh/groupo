import { useContext} from 'react'
import {AuthContext} from '../../Utils/context/index'
import {IconButton } from '@mui/material'
import ThumbDownAltIcon from '@mui/icons-material/ThumbDownAlt'


            <Box sx={{ display: 'flex', justifyContent:"space-between"}}>
            <div>
                <LikeButton id = {post.id} likes= {post.likes}/>
                <DisLikeButton id = {post.id} dislikes= {post.dislikes} />
            </div>

            </Box>

export default async function DisLikeButton (props) {  

  const dislikes = props.dislikes
  const id = props.id
  const authDatas  = useContext(AuthContext); 
  const userID = authDatas.userId 
  const toogleEffect = authDatas.toogleEffect  
  const setToogleEffect = authDatas.setToogleEffect 


  async function dislike () {

    try{
      const response = await fetch(`http://localhost:3001/api/posts/:${id}/dislike`, {
        mode: "cors",
        method: "POST",
        body: JSON.stringify({ id: id, userID: userID} ),
        headers: {"Content-Type": "application/json",
                  "Authorization":  "????",
      }})
  
      if (!response.ok) {
        const result = await response.json()
        console.log(result)
        throw new Error(`${response.status}. ${result}`)
      } else{
        const result = await response.json()
        setToogleEffect(! toogleEffect)
        console.log(result.message)
        } 
    } 
    catch(err){
      const errorMessage = err.toString();
      console.log(errorMessage)
    }
  }

  return (
    <IconButton onClick={() => {dislike()}}> 
      < ThumbDownAltIcon color="secondary" sx={{ fontSize: 30 }} /> 
      <span> {dislikes}</span>
    </IconButton>
  )
}